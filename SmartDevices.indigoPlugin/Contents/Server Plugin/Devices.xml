<?xml version="1.0"?>
<!-- If your plugin defines device types, you can define them here.

	 Devices must specify their type (via the type attribute):

		relay (ON/OFF/STATUS)
		dimmer (ON/OFF/DIM/BRIGHTEN/SET BRIGHTNESS/STATUS)
		speedcontrol (ON/OFF/SET SPEED LEVEL/SET SPEED INDEX/INCREASE/DECREASE/STATUS)
		sensor (ON/OFF/STATUS)
		thermostat
		sprinkler (ACTIVE ZONE INDEX)
		custom

	 The first six inherit states, actions and events from Indigo. You can
	 also specify your own custom actions and additional states, if needed.

	 The Device example below specifies the thermostat type.
	 
	 Devices must also specify a unique typeID - so, for instance, if you define
	 2 different thermostat type devices then your plugin can distinguish between
	 the two by the typeID.
-->

<!--suppress XmlUnboundNsPrefix, XmlUnboundNsPrefix, CheckTagEmptyBody, CheckTagEmptyBody, CheckTagEmptyBody, CheckTagEmptyBody, CheckTagEmptyBody -->
<Devices>
    <Device type="thermostat" id="simpleSmartThermostat">
		<Name>Simple Smart Thermostat</Name>
		<ConfigUI>
			<Field id="autoLabel21" type="label">
				<Label>Heater device(s):
Select the devices you want to use for heating. The device must be an On/Off device like a relay switch. All the devices selected will be turned On when heating is required and Off when temperature is adequate.</Label>
			</Field>
			<Field id="primaryHeaterDevices" type="list">
				<Label>Select Heater Device(s):</Label>
				<List class="self" method="heaterDevicesList"/> <!-- filter="indigo.relay,indigo.thermostat"-->
			</Field>
			<Field id="clearHVACDevices"
				type="button"
				tooltip="This will reset Heater Device selections">
				<Label></Label>
				<Title>Clear Heater Device selections</Title>
				<CallbackMethod>ClearHVACDevicesPressed</CallbackMethod>
			</Field>
			<Field id="simpleSeparator21" type="separator"/>
			<Field id="autoLabel22" type="label">
				<Label>Temperature sensor(s):
Temperature sensor(s) will be used to control the heater device(s) selected above. You must make sure that you are selecting temperature sensor devices.
If you select multiple devices, these will be averaged when calculating heaters On/Off against the set point.
Multiple Temperature senors can also complement each other if some of them fails or have old values.You can use both Devices and Variables to collect temperature sensor values.
When using Variables, NOTE that these do not have an updated timestamp so there is no check if the value is old.</Label>
			</Field>
            <Field id='sensorInputOptions' type='menu' defaultValue="0">
				<Label>Temperature Sensor Input Sources:</Label>
				<List>
					<Option value="0">Device(s)</Option>
					<Option value="1">Variable(s)</Option>
					<Option value="2">Both</Option>
				</List>
			</Field>
			<Field id="primaryTemperatureSensors" type="list" visibleBindingId='sensorInputOptions' visibleBindingValue='0,2'>
				<Label>Select Temperature sensor(s):</Label>
				<List class="indigo.devices" filter="indigo.sensor"/>
			</Field>
			<Field id="clearTemperatureDevices"
				type="button"
				tooltip="This will reset Temperaturesensor Device selection" visibleBindingId='sensorInputOptions' visibleBindingValue='0,2'>
				<Label></Label>
				<Title>Clear Temp. Device selections</Title>
				<CallbackMethod>ClearTemperatureDevicesPressed</CallbackMethod>
			</Field>

            <Field id="primaryTemperatureVariables" type="list" visibleBindingId='sensorInputOptions' visibleBindingValue='1,2'>
				<Label>Select Temperature Variables:</Label>
				<List class="indigo.variables"/>
			</Field>
			<Field id="clearTemperatureVariables"
				type="button"
				tooltip="This will reset Temperature Variable selection" visibleBindingId='sensorInputOptions' visibleBindingValue='1,2'>
				<Label></Label>
				<Title>Clear Temp. Variables selections</Title>
				<CallbackMethod>ClearTemperatureVariablesPressed</CallbackMethod>
			</Field>
			<Field id="simpleSeparator23" type="separator"/>
			<Field id="autoLabel24" type="label">
				<Label>Thermostat Configuration:</Label>
			</Field>

            <Field id='useVariableSetPoint' type='checkbox' >
				<Label>Link Thermostat Setpoint with Variable: </Label>
			</Field>
            <Field id="autoLabel23" type="label" visibleBindingId='useVariableSetPoint' visibleBindingValue='true'>
				<Label>The thermostat setpoint will be linked with the selected variable. Updates in setpoint will update the variable, and updates in variable will update the setpoint</Label>
			</Field>
            <Field id="SetPointVariable" type="menu" visibleBindingId='useVariableSetPoint' visibleBindingValue='true'>
				<Label>Select Setpoint Link Variable:</Label>
				<List class="indigo.variables"/>
			</Field>
			<Field id="configTemperatureDelta" type="textfield" defaultValue="0.2">
				<Label>Temperature delta:</Label>
			</Field>
            <Field id="autoLabel25" type="label">
				<Label>The simple thermostat logic works so that when the average of the temperature sensors falls below (Heat Set Point - Temperature Delta), Heaters will turn On.
When the average temperature sensors is above (Heat Set Point + Temperature Delta), Heaters will turn Off</Label>
			</Field>
		</ConfigUI>
		<States>
			<State id="temperatureDelta">
				<ValueType>Float</ValueType>
				<TriggerLabel>Temperature Delta</TriggerLabel>
				<ControlPageLabel>Temperature Delta</ControlPageLabel>
			</State>
		</States>
	</Device>
</Devices>
